select distinct '01' as ProcessMonth,'2025' as ProcessYear, tab.vendorcode,VM.V_NAME,tab.workorder,tab.from_date,tab.to_date,isnull(DM.DepartmentCode, 'Work Order Not Registered') as DepartmentCode,isnull(DM.DepartmentName, 'Work Order Not Registered') as DepartmentName,isnull(LM.Location, 'Work Order Not Registered') Location,isnull((select top 1 EMAIL = STUFF((SELECT DISTINCT ', ' + (NAME + '-' + CONTACT_NO) from App_Vendor_Representative as b where b.CREATEDBY = tab.vendorcode FOR XML PATH('')), 1, 2, '') FROM App_Vendor_Representative as a  ),'Vendor Registration Not Done') as RESPONSIBLE_PERSON_OF_THE_CONTRACTOR ,  isnull((select distinct  isnull(OW.L1_VERIFIERNAME, 'Wages Not Approved Or Not Applied Yet')  from App_Online_Wages OW inner join App_Online_Wages_Details OWD on OWD.MonthWage = OW.MonthWage and OWD.YearWage = OW.YearWage and OWD.VendorCode = OW.V_CODE and OWD.WorkOrderNo = tab.workorder where OW.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and OW.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59') and OW.STATUS = 'Request Closed'   and OW.V_CODE = tab.vendorcode),'Wages Not Approved Or Not Applied Yet') as Wage_HR_COORDINATOR ,  isnull((select distinct  isnull(PES.L1_VerifierName, 'PF/ESI Not Approved Or Not Applied Yet')   from App_PF_ESI_Summary PES inner join App_PF_ESI_Details PED on PED.MonthWage = PES.MonthWage and PED.YearWage = PES.YearWage and PED.VendorCode = PES.VendorCode and PED.WorkOrderNo = tab.workorder where PES.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and PES.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59') and PES.Status = 'Request Closed'  and PES.VendorCode = tab.vendorcode),'PF/ESI Not Approved Or Not Applied Yet' ) as PF_ESI_HR_COORDINATOR ,  (select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl  and EM.Sex = 'M' where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0  ) as MALE_NO_OF_MALE_WORKERS ,  (select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and EM.Sex = 'M' and EM.Social_Category in ('ST', 'SC') where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0 ) as MALE_NOS_OF_SC_ST_WORKERS,(select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD  inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and EM.Sex = 'M' and EM.Social_Category in ('OBC') where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0 ) as MALE_NOS_OF_OBC_WORKERS, isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD  inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'M' and WD.WorkOrderNo = tab.workorder where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode),'0') as MALE_MANDAYS,isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'M' and EM.Social_Category in ('ST', 'SC')  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder),'0') as MALE_MANDAYS_SC_ST, isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'M' and EM.Social_Category in ('OBC')  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder),'0') as MALE_MANDAYS_OBC, (select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD  inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and EM.Sex = 'F'  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0 ) as FEMALE_NO_OF_MALE_WORKERS,(select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and EM.Sex = 'F' and EM.Social_Category in ('ST', 'SC') where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0 ) as FEMALE_NOS_OF_SC_ST_WORKERS ,  (select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and EM.Sex = 'F' and EM.Social_Category in ('OBC') where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0 ) as FEMALE_NOS_OF_OBC_WORKERS ,  isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'F'  and WD.WorkOrderNo = tab.workorder  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode),'0') as FEMALE_MANDAYS,isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'F' and EM.Social_Category in ('ST', 'SC')  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder),'0') as FEMALE_MANDAYS_SC_ST, isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'F' and EM.Social_Category in ('OBC')  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder),'0') as FEMALE_MANDAYS_OBC, (select distinct count(WD.AadharNo) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Unskilled' and WD.WorkOrderNo = tab.workorder) as UNSKILLED_NOS_OF_WORKERS ,  isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Unskilled' and WD.WorkOrderNo = tab.workorder),'0') as UNSKILLED_TOTAL_MANDAYS,isnull((select distinct cast(AVG(WD.DARate) + AVG(WD.BasicRate) as decimal(18, 2)) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Unskilled' and WD.WorkOrderNo = tab.workorder),0.00) as UNSKILLED_DAILY_WAGES_RATE ,  (select distinct count(WD.AadharNo) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Semi Skilled' and WD.WorkOrderNo = tab.workorder) as SEMISKILLED_NOS_OF_WORKERS,isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Semi Skilled' and WD.WorkOrderNo = tab.workorder),'0') as SEMISKILLED_TOTAL_MANDAYS ,  isnull((select distinct cast(AVG(WD.DARate) + AVG(WD.BasicRate) as decimal(18, 2)) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Semi Skilled' and WD.WorkOrderNo = tab.workorder),0.00) as SEMISKILLED_DAILY_WAGES_RATE, (select distinct count(WD.AadharNo) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Skilled' and WD.WorkOrderNo = tab.workorder) as SKILLED_NOS_OF_WORKERS ,  isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Skilled' and WD.WorkOrderNo = tab.workorder),'0') as SKILLE
D_TOTAL_MANDAYS, isnull((select distinct cast(AVG(WD.DARate) + AVG(WD.BasicRate) as decimal(18, 2)) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Skilled' and WD.WorkOrderNo = tab.workorder),0.00) as SKILLED_DAILY_WAGES_RATE ,  (select distinct count(WD.AadharNo) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Highly Skilled' and WD.WorkOrderNo = tab.workorder) as HIGHLYSKILLED_NOS_OF_WORKERS,isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Highly Skilled' and WD.WorkOrderNo = tab.workorder),'0') as HIGHLYSKILLED_TOTAL_MANDAYS,isnull((select distinct cast(AVG(WD.DARate) + AVG(WD.BasicRate) as decimal(18, 2)) from App_WagesDetailsJharkhand WD  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Highly Skilled' and WD.WorkOrderNo = tab.workorder),0.00) as HIGHLYSKILLED_DAILY_WAGES_RATE,(select distinct count(WD.AadharNo) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Other' and WD.WorkOrderNo = tab.workorder) as Other_NOS_OF_WORKERS,isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Other' and WD.WorkOrderNo = tab.workorder),'0') as Other_TOTAL_MANDAYS,isnull((select distinct  cast(AVG(WD.DARate) + AVG(WD.BasicRate) as decimal(18, 2)) from App_WagesDetailsJharkhand WD  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Other' and WD.WorkOrderNo = tab.workorder),0.00) as Other_DAILY_WAGES_RATE,isnull((select distinct sum(WD.DAWages) + Sum(WD.BasicWages) from App_WagesDetailsJharkhand WD  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode  and WD.WorkOrderNo = tab.workorder),'0') as BASIC_DA,isnull((select distinct sum(WD.OtherAllow) from App_WagesDetailsJharkhand WD  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode  and WD.WorkOrderNo = tab.workorder),'0') as ALLOWANCES, isnull((select distinct sum(WD.TotalWages) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode  and WD.WorkOrderNo = tab.workorder),'0') as GROSS_WAGES ,  isnull((select distinct sum(WD.PFAmt) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode  and WD.WorkOrderNo = tab.workorder),'0') as PF_DEDUCTION, isnull((select distinct sum(WD.ESIAmt) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode  and WD.WorkOrderNo = tab.workorder),'0') as ESI_DEDUCTION ,  isnull((select distinct sum(WD.OtherDeduAmt) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode  and WD.WorkOrderNo = tab.workorder),'0') as OTHER_DEDUCTION, isnull((select distinct sum(WD.NetWagesAmt) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode  and WD.WorkOrderNo = tab.workorder),'0') as NET_WAGES_PAYMENT ,  isnull((select distinct Convert(varchar(50), OW.PAYMENT_DATE, 103) from App_Online_Wages OW inner join App_Online_Wages_Details OWD on OWD.MonthWage = OW.MonthWage and OWD.YearWage = OW.YearWage and OWD.VendorCode = OW.V_CODE and OWD.WorkOrderNo = tab.workorder where OW.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and OW.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59') and OW.STATUS = 'Request Closed' and OW.V_CODE = tab.vendorcode),'Wage Compliance Not Approved Or Not Applied Yet') as Payment_date_WAGES, isnull((select distinct Convert(varchar(50), PES.PFChallanDate, 103) from App_PF_ESI_Summary PES  inner join App_PF_ESI_Details PED on PED.MonthWage = PES.MonthWage and PED.YearWage = PES.YearWage and PED.VendorCode = PES.VendorCode and PED.WorkOrderNo = tab.workorder where PES.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and PES.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59') and PES.Status = 'Request Closed' and PES.VendorCode = tab.vendorcode),'PF/ESI Compliance Not Approved Or Not Applied Yet') as Payment_Date_PF,isnull((select distinct convert(varchar(50), PES.ESIChallanDate, 103) from App_PF_ESI_Summary PES inner join App_PF_ESI_Details PED on PED.MonthWage = PES.MonthWage and PED.YearWage = PES.YearWage and PED.VendorCode = PES.VendorCode and PED.WorkOrderNo = tab.workorder  where PES.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and PES.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59') and PES.Status = 'Request Closed'  and PES.VendorCode = tab.vendorcode),'PF/ESI Compliance Not Approved Or Not Applied Yet') as Payment_Date_ESI,isnull((select top 1 'YES' from APP_RECOGNIZED_WO where V_CODE=tab.vendorcode and WO_NO=tab.workorder),'NO') as Exempted_Order_for_Compliance ,  case when(select count(R.WO_NO) from APP_RECOGNIZED_WO R where R.V_CODE = tab.vendorcode and R.WO_NO = tab.workorder group by R.WO_NO) > 0 then 'Not Applicable' else (select distinct top 1 (case when(STATUS in ('Pending With L2 Level', 'Pending with L1 Level')) then 'Pending With Verifier  ' else case when OW.status in ('Pending With Vendor', 'Saved as Draft') then 'Pending With Vendor  ' else case when OW.status = 'Request Closed' then 'Complied'  end end end )as status from App_Online_Wages OW inner join App_Online_Wages_Details OWD on OWD.MonthWage = OW.MonthWage and OWD.YearWage = OW.YearWage and OWD.VendorCode = OW.V_CODE and OWD.WorkOrderNo = tab.workorder where OW.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and OW.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59') and OW.V_CODE = tab.vendorcode group by OW.status) end as Compliance_Status,  isnull((select distinct case when OW.PAYMENT_DATE > convert(datetime, '05/07/2024') then 'YES' else 'NO' end from App_Online_Wages OW inner join App_Online_Wages_Details OWD on OWD.MonthWage = OW.MonthWage and OWD.YearWage = OW.YearWage and OWD.VendorCode = OW.V_CODE and OWD.WorkOrderNo = tab.workorder  where OW.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and OW.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59') and OW.STATUS = 'Request Closed' and OW.V_CODE = tab.vendorcode ),'NO') as Wage_colour,isnull((select distinct case when PES.PFChallanDate > convert(datetime, '05/15/2024') then 'YES' else 'NO' end from App_PF_ESI_Summary PES inner join App_PF_ESI_Details PED on PED.MonthWage = PES.MonthWage and PED.YearWage = PES.YearWage and PED.VendorCode = PES.VendorCode and PED.WorkOrderNo = tab.workorder where PES.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and PES.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59') and PES.Status = 'Request Closed' and PES.VendorCode = tab.vendorcode ),'NO') as PF_colour ,  isnull((select distinct case when PES.ESIChallanDate > convert(datetime, '05/15/2024') then 'YES' else 'NO' end from App_PF_ESI_Summary PES inner join App_PF_ESI_Details PED on PED.MonthWage = PES.MonthWage and PED.YearWage = PES.YearWage and PED.VendorCode = PES.VendorCode and PED.WorkOrderNo = tab.workorder where PES.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and PES.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59') and PES.Status = 'Request Closed'  and PES.VendorCode = tab.vendorcode ),'NO') as ESI_colour ,  ((select distinct count(WD.AadharNo) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Unskilled' and WD.WorkOrderNo = tab.workorder)+(select distinct count(WD.AadharNo) from App_WagesDetailsJharkhand WD  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Semi Skilled' and WD.WorkOrderNo = tab.workorder)+(select distinct count(WD.AadharNo) from App_WagesDetailsJharkhand WD  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Skilled' and WD.WorkOrderNo = tab.workorder) + (select distinct count(WD.AadharNo) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Highly Skilled' and WD.WorkOrderNo = tab.workorder)+(select distinct count(WD.AadharNo) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Other' and WD.WorkOrderNo = tab.workorder) ) as Total_NOS_OF_WORKERS ,  (isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Unskilled' and WD.WorkOrderNo = tab.workorder), 0) + isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Semi Skilled' and WD.WorkOrderNo = tab.workorder),0)+ isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Skilled' and WD.WorkOrderNo = tab.workorder),0)+  isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Highly Skilled' and WD.WorkOrderNo = tab.workorder),0)+ isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkManCategory = 'Other' and WD.WorkOrderNo = tab.workorder),0) ) as Total_Mandays,tab.Description from (select V_CODE as vendorcode, WO_NO as workorder, Convert(varchar, START_DATE, 103) as from_date, Convert(varchar, END_DATE, 103) as to_date, DEPT_CODE as DepartmentCode, TXZ01 as Description from App_Vendorwodetails where START_DATE < '2025-01-31 23:59:59' and END_DATE > '2025-1-01 00:00:00.000') tab  left join App_VendorMaster VM on VM.V_CODE = tab.vendorcode  left join App_DepartmentMaster DM on DM.DepartmentCode = tab.DepartmentCode  left join App_WorkOrder_Reg WOR on WOR.WO_NO = tab.workorder  left join App_LocationMaster LM on LM.LocationCode = WOR.LOC_OF_WORK  where  1=1   order by tab.vendorcode 
