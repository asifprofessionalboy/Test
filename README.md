 select distinct '01' as ProcessMonth,'2025' as ProcessYear, tab.vendorcode,VM.V_NAME,tab.workorder,tab.from_date,tab.to_date,isnull(DM.DepartmentCode, 'Work Order Not Registered') as DepartmentCode,isnull(DM.DepartmentName, 'Work Order Not Registered') as DepartmentName,isnull(LM.Location, 'Work Order Not Registered') Location,isnull((select top 1 EMAIL = STUFF((SELECT DISTINCT ', ' + (NAME + '-' + CONTACT_NO) from App_Vendor_Representative as b where b.CREATEDBY = tab.vendorcode FOR XML PATH('')), 1, 2, '') FROM App_Vendor_Representative as a  ),'Vendor Registration Not Done') as RESPONSIBLE_PERSON_OF_THE_CONTRACTOR ,  isnull((select distinct  isnull(OW.L1_VERIFIERNAME, 'Wages Not Approved Or Not Applied Yet')  from App_Online_Wages OW inner join App_Online_Wages_Details OWD on OWD.MonthWage = OW.MonthWage and OWD.YearWage = OW.YearWage and OWD.VendorCode = OW.V_CODE and OWD.WorkOrderNo = tab.workorder where OW.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and OW.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59') and OW.STATUS = 'Request Closed'   and OW.V_CODE = tab.vendorcode),'Wages Not Approved Or Not Applied Yet') as Wage_HR_COORDINATOR ,  isnull((select distinct  isnull(PES.L1_VerifierName, 'PF/ESI Not Approved Or Not Applied Yet')   from App_PF_ESI_Summary PES inner join App_PF_ESI_Details PED on PED.MonthWage = PES.MonthWage and PED.YearWage = PES.YearWage and PED.VendorCode = PES.VendorCode and PED.WorkOrderNo = tab.workorder where PES.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and PES.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59') and PES.Status = 'Request Closed'  and PES.VendorCode = tab.vendorcode),'PF/ESI Not Approved Or Not Applied Yet' ) as PF_ESI_HR_COORDINATOR ,  (select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl  and EM.Sex = 'M' where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0  ) as MALE_NO_OF_MALE_WORKERS ,  (select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and EM.Sex = 'M' and EM.Social_Category in ('ST', 'SC') where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0 ) as MALE_NOS_OF_SC_ST_WORKERS,(select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD  inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and EM.Sex = 'M' and EM.Social_Category in ('OBC') where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0 ) as MALE_NOS_OF_OBC_WORKERS, isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD  inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'M' and WD.WorkOrderNo = tab.workorder where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode),'0') as MALE_MANDAYS,isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'M' and EM.Social_Category in ('ST', 'SC')  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder),'0') as MALE_MANDAYS_SC_ST, isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'M' and EM.Social_Category in ('OBC')  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder),'0') as MALE_MANDAYS_OBC, (select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD  inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and EM.Sex = 'F'  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0 ) as FEMALE_NO_OF_MALE_WORKERS,(select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and EM.Sex = 'F' and EM.Social_Category in ('ST', 'SC') where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0 ) as FEMALE_NOS_OF_SC_ST_WORKERS ,  (select distinct count(EM.AadharCard) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and EM.Sex = 'F' and EM.Social_Category in ('OBC') where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder and WD.TotPaymentDays > 0 ) as FEMALE_NOS_OF_OBC_WORKERS ,  isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'F'  and WD.WorkOrderNo = tab.workorder  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode),'0') as FEMALE_MANDAYS,isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'F' and EM.Social_Category in ('ST', 'SC')  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder),'0') as FEMALE_MANDAYS_SC_ST, isnull((select distinct sum(WD.TotPaymentDays) from App_WagesDetailsJharkhand WD inner join App_EmployeeMaster EM on EM.AadharCard = WD.AadharNo and EM.VendorCode = WD.VendorCode and EM.WorkManSlNo = WD.WorkManSl and  EM.Sex = 'F' and EM.Social_Category in ('OBC')  where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:59')  and WD.VendorCode = tab.vendorcode and WD.WorkOrderNo = tab.workorder),'0') as FEMALE_MANDAYS_OBC, (select distinct count(WD.AadharNo) from App_WagesDetailsJharkhand WD where WD.MonthWage = DATEPART(month, '2025-01-31 23:59:59') and WD.YearWage = DATEPART(YEAR, '2025-01-31 23:59:5
